<div class="row" id="main-info" style="margin-top: 0px;">
  <div class="col m12">
    {{ form_start(property_form, {'action': path('properties_save'), 'method': 'POST', 'id':'property_form'}) }}
      <div class="card">
        <div class="title">
          <h5> Basic Information </h5>
          <div class="btn-group right">
            <a href="#!" class="waves-effect waves-dark btn btn-small">
              <i class="mdi mdi-navigation-chevron-left left"></i> Back
            </a>
            <button type="submit" id="btn-save" class="waves-effect waves-dark btn btn-small">
              <i class="mdi mdi-content-save left"></i> Save
            </button>
          </div>
        </div>
        <div class="content" style="padding-top: 5px;padding-bottom: 5px;">
          <div class="input-field">
            {{ form_widget(property_form.name) }}
            <label for="property_name" class="">Property Name</label>
          </div>
          <div class="input-field">
            {{ form_widget(property_form.description, {'attr': {'class':'materialize-textarea'}}) }}
            <label for="property_description">Property Description</label>
          </div>
        </div>
      </div>
      <div class="card">
        <div class="title">
          <h5> Attributes </h5>
        </div>
        <div class="content" style="padding-top: 5px;padding-bottom: 15px;">
          <div class="row" style="margin-top: 5px;">
            <div class="col m6">
              <div class="input-field">
                {{ form_widget(property_form.bedrooms) }}
                <label for="property_bedrooms" class="">Rooms</label>
              </div>
              <div class="input-field">
                {{ form_widget(property_form.bathrooms) }}
                <label for="property_bathrooms" class="">Baths</label>
              </div>
              <div class="input-field">
                {{ form_widget(property_form.parking_spaces) }}
                <label for="property_parking_spaces" class="">Parking</label>
              </div>
              <div class="input-field">
                {{ form_widget(property_form.unit_size) }}
                <label for="property_unit_size" class="">Unit Size</label>
              </div>
              <div class="input-field">
                {{ form_widget(property_form.year_built) }}
                <label for="property_year_built" class="">Year Built</label>
              </div>
              <div class="input-field" style="margin-top: 3px;">
                {{ form_widget(property_form.list_price) }}
                <label for="property_list_price" class="">Price</label>
              </div>
              <div class="input-field">
                {{ form_widget(property_form.lease_term) }}
                <label for="property_lease_term" class="">Lease Term</label>
              </div>
            </div>
            <div class="col m6">
              <div class="input-field">
                {{ form_widget(property_form.type)}}
                {#<select class="select2">#}
                  {#<option value="AK">Apartament</option>#}
                  {#<option value="HI">Condo</option>#}
                  {#<option value="HI">House</option>#}
                  {#<option value="HI">Villa</option>#}
                {#</select>#}
              </div>
              <div class="input-field">
                {{ form_widget(property_form.address, {'attr':{'placeholder':''}}) }}
                <label for="property_address" class="">Address</label>
              </div>
              <div class="input-field">
                {{ form_widget(property_form.unit) }}
                <label for="property_unit" class="">Unit</label>
              </div>
              <div class="input-field">
                {{ form_widget(property_form.city) }}
                <label for="property_city" class="">City</label>
              </div>
              <div class="input-field">
                {{ form_widget(property_form.state) }}
                <label for="property_state" class="">State</label>
              </div>
              <div class="input-field">
                {{ form_widget(property_form.country) }}
                <label for="property_country" class="">Country</label>
              </div>
              <div class="input-field">
                <div class="row" style="margin-top: 0px;">
                  <div class="col m6">
                    <div class="input-field" style="margin-top: 0px !important;">
                      {{ form_widget(property_form.postal_code) }}
                      <label for="property_postal_code" class="">Postal Code</label>
                    </div>
                  </div>
                  <div class="col m6">
                    <p style="margin-top: 5px;">
                      {{ form_widget(property_form.for_rent, {'attr': {'class':'filled-in'}}) }}
                      <label for="property_for_rent">Is it for rent?</label>
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="title">
          <h5> Amenities and Features </h5>
        </div>
        <div class="content" style="padding-top: 5px;padding-bottom: 5px;">
          <div class="row" style="margin-top: 0px">
            <div class="col m6">
              <div class="input-field">
                {{ form_widget(property_form.amenities, {'attr': {'class':'materialize-textarea'}}) }}
                <label for="property_amenities">Amenities</label>
              </div>
            </div>
            <div class="col m6">
              <div class="input-field">
                {{ form_widget(property_form.features, {'attr': {'class':'materialize-textarea'}}) }}
                <label for="property_features">Features</label>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="title">
          <h5> Location </h5>
        </div>
        <div class="content" style="padding-top: 5px;padding-bottom: 15px;">
          <div class="row" style="margin-top: 5px">
            <div class="col m12" style="padding-bottom: 5px;">
              <div id="map-canvas"></div>
            </div>
          </div>
          <div class="row" style="margin-top: 5px"></div>
        </div>
      </div>
      {{ form_widget(property_form.lat) }}
      {{ form_widget(property_form.lng) }}
      <input type="hidden" value="{{ property_id }}" name="property_id" >
    {{ form_end(property_form) }}
  </div>
</div>

<script>
  $(document).ready(function(){

    if ($('#map-canvas').length != 0) {
      var lat = {{ property.lat ? property.lat : '25.7823072' }};
      var lng = {{ property.lng ? property.lng : '-80.3011208' }};
      var map_input_id = 'property_address';
      var map_input_lat_id = 'property_lat';
      var map_input_lng_id = 'property_lng';
      var show_marker = '{{ property.lat and property.lng ? 'true'}}';
      google.maps.event.addDomListener(window, 'load', initialize(lat, lng,
              map_input_id, map_input_lat_id, map_input_lng_id, show_marker));
    }

    var componentForm = {
      street_number: 'short_name',
      route: 'long_name',
      locality: 'long_name',
      administrative_area_level_1: 'short_name',
      country: 'short_name',
      postal_code: 'short_name'
    };

    var componentFormId = {
      street_number: 'property_unit',
      route: 'form_route',
      locality: 'property_city',
      administrative_area_level_1: 'property_state',
      country: 'property_country',
      postal_code: 'property_postal_code'
    };

    google.maps.event.addListener(map_autocomplete, 'place_changed', function () {
      var place = map_autocomplete.getPlace();
      if (!place.geometry) {
        return;
      }

      for (var i = 0; i < place.address_components.length; i++) {
        var addressType = place.address_components[i].types[0];
        if (addressType == "sublocality_level_1") {
          addressType = "locality";
        }
        if (componentForm[addressType]) {

          var val = place.address_components[i][componentForm[addressType]];

          if ($('#' + componentFormId[addressType]).length) {
            $('#' + componentFormId[addressType]).val(val).change();
          }
        }
      }
    });
  });
</script>